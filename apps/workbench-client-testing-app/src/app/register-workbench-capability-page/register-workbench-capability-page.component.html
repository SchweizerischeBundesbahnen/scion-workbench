<form autocomplete="off" [formGroup]="form">
  <section>
    <sci-form-field label="Type">
      <select [formControl]="form.controls.type" class="e2e-type">
        <option [value]="WorkbenchCapabilities.Perspective">PERSPECTIVE</option>
        <option [value]="WorkbenchCapabilities.View">VIEW</option>
        <option [value]="WorkbenchCapabilities.Dialog">DIALOG</option>
        <option [value]="WorkbenchCapabilities.MessageBox">MESSAGEBOX</option>
        <option [value]="WorkbenchCapabilities.Popup">POPUP</option>
      </select>
    </sci-form-field>

    <sci-form-field label="Qualifier">
      <sci-key-value-field [keyValueFormArray]="form.controls.qualifier" [addable]="true" [removable]="true" class="e2e-qualifier"/>
    </sci-form-field>

    <sci-form-field label="Required Params">
      <input [formControl]="form.controls.requiredParams" class="e2e-required-params" placeholder="param1,param2,...">
    </sci-form-field>
    <sci-form-field label="Optional Params">
      <input [formControl]="form.controls.optionalParams" class="e2e-optional-params" placeholder="param1,param2,...">
    </sci-form-field>
    @if (form.controls.type.value === WorkbenchCapabilities.View) {
      <sci-form-field label="Transient Params">
        <input [formControl]="form.controls.transientParams" class="e2e-transient-params" placeholder="param1,param2,...">
      </sci-form-field>
    }
    <sci-form-field label="Private">
      <sci-checkbox [formControl]="form.controls.private" class="e2e-private"/>
    </sci-form-field>
  </section>

  <section>
    <header>Properties</header>

    @switch (form.controls.type.value) {
      @case (WorkbenchCapabilities.Perspective) {
        <app-perspective-capability-properties [formControl]="form.controls.perspectiveProperties"/>
      }
      @case (WorkbenchCapabilities.View) {
        <sci-form-field label="Path">
          <input [formControl]="form.controls.viewProperties.controls.path" class="e2e-path">
        </sci-form-field>

        <sci-form-field label="Title">
          <input [formControl]="form.controls.viewProperties.controls.title" class="e2e-title">
        </sci-form-field>

        <sci-form-field label="Heading">
          <input [formControl]="form.controls.viewProperties.controls.heading" class="e2e-heading">
        </sci-form-field>

        <sci-form-field label="Resolve">
          <app-record [formControl]="form.controls.viewProperties.controls.resolve" class="e2e-resolve"/>
        </sci-form-field>

        <sci-form-field label="Closable">
          <sci-checkbox [formControl]="form.controls.viewProperties.controls.closable" class="e2e-closable"/>
        </sci-form-field>

        <sci-form-field label="Show Splash">
          <sci-checkbox [formControl]="form.controls.viewProperties.controls.showSplash" class="e2e-show-splash"/>
        </sci-form-field>

        <sci-form-field label="CSS Class(es)">
          <app-multi-value-input [formControl]="form.controls.viewProperties.controls.cssClass" [placeholder]="'class-1 class-2'" class="e2e-class"/>
        </sci-form-field>

        <sci-form-field label="Pin to Desktop">
          <sci-checkbox [formControl]="form.controls.viewProperties.controls.pinToDesktop" class="e2e-pin-to-desktop"/>
        </sci-form-field>
      }
      @case (WorkbenchCapabilities.Popup) {
        <sci-form-field label="Path">
          <input [formControl]="form.controls.popupProperties.controls.path" class="e2e-path">
        </sci-form-field>

        <sci-form-field label="Min Height">
          <input [formControl]="form.controls.popupProperties.controls.size.controls.minHeight" class="e2e-min-height">
        </sci-form-field>

        <sci-form-field label="Height">
          <input [formControl]="form.controls.popupProperties.controls.size.controls.height" class="e2e-height">
        </sci-form-field>

        <sci-form-field label="Max Height">
          <input [formControl]="form.controls.popupProperties.controls.size.controls.maxHeight" class="e2e-max-height">
        </sci-form-field>

        <sci-form-field label="Min Width">
          <input [formControl]="form.controls.popupProperties.controls.size.controls.minWidth" class="e2e-min-width">
        </sci-form-field>

        <sci-form-field label="Width">
          <input [formControl]="form.controls.popupProperties.controls.size.controls.width" class="e2e-width">
        </sci-form-field>

        <sci-form-field label="Max Width">
          <input [formControl]="form.controls.popupProperties.controls.size.controls.maxWidth" class="e2e-max-width">
        </sci-form-field>

        <sci-form-field label="Show Splash">
          <sci-checkbox [formControl]="form.controls.popupProperties.controls.showSplash" class="e2e-show-splash"/>
        </sci-form-field>

        <sci-form-field label="Pin to Desktop">
          <sci-checkbox [formControl]="form.controls.popupProperties.controls.pinToDesktop" class="e2e-pin-to-desktop"/>
        </sci-form-field>

        <sci-form-field label="CSS Class(es)">
          <app-multi-value-input [formControl]="form.controls.popupProperties.controls.cssClass" [placeholder]="'class-1 class-2'" class="e2e-class"/>
        </sci-form-field>
      }
      @case (WorkbenchCapabilities.Dialog) {
        <sci-form-field label="Path">
          <input [formControl]="form.controls.dialogProperties.controls.path" class="e2e-path">
        </sci-form-field>

        <sci-form-field label="Min Height">
          <input [formControl]="form.controls.dialogProperties.controls.size.controls.minHeight" class="e2e-min-height">
        </sci-form-field>

        <sci-form-field label="Height">
          <input [formControl]="form.controls.dialogProperties.controls.size.controls.height" class="e2e-height">
        </sci-form-field>

        <sci-form-field label="Max Height">
          <input [formControl]="form.controls.dialogProperties.controls.size.controls.maxHeight" class="e2e-max-height">
        </sci-form-field>

        <sci-form-field label="Min Width">
          <input [formControl]="form.controls.dialogProperties.controls.size.controls.minWidth" class="e2e-min-width">
        </sci-form-field>

        <sci-form-field label="Width">
          <input [formControl]="form.controls.dialogProperties.controls.size.controls.width" class="e2e-width">
        </sci-form-field>

        <sci-form-field label="Max Width">
          <input [formControl]="form.controls.dialogProperties.controls.size.controls.maxWidth" class="e2e-max-width">
        </sci-form-field>

        <sci-form-field label="Title">
          <input [formControl]="form.controls.dialogProperties.controls.title" class="e2e-title">
        </sci-form-field>

        <sci-form-field label="Resolve">
          <app-record [formControl]="form.controls.dialogProperties.controls.resolve" class="e2e-resolve"/>
        </sci-form-field>

        <sci-form-field label="Closable">
          <sci-checkbox [formControl]="form.controls.dialogProperties.controls.closable" class="e2e-closable"/>
        </sci-form-field>

        <sci-form-field label="Resizable">
          <sci-checkbox [formControl]="form.controls.dialogProperties.controls.resizable" class="e2e-resizable"/>
        </sci-form-field>

        <sci-form-field label="Padding">
          <sci-checkbox [formControl]="form.controls.dialogProperties.controls.padding" class="e2e-padding"/>
        </sci-form-field>

        <sci-form-field label="Show Splash">
          <sci-checkbox [formControl]="form.controls.dialogProperties.controls.showSplash" class="e2e-show-splash"/>
        </sci-form-field>

        <sci-form-field label="CSS Class(es)">
          <app-multi-value-input [formControl]="form.controls.dialogProperties.controls.cssClass" [placeholder]="'class-1 class-2'" class="e2e-class"/>
        </sci-form-field>
      }
      @case (WorkbenchCapabilities.MessageBox) {
        <ng-container [formGroup]="this.form.controls.messageBoxProperties">
          <sci-form-field label="Path">
            <input [formControl]="this.form.controls.messageBoxProperties.controls.path" class="e2e-path">
          </sci-form-field>

          <ng-container [formGroup]="this.form.controls.messageBoxProperties.controls.size">
            <sci-form-field label="Min Height">
              <input [formControl]="this.form.controls.messageBoxProperties.controls.size.controls.minHeight" class="e2e-min-height">
            </sci-form-field>

            <sci-form-field label="Height">
              <input [formControl]="this.form.controls.messageBoxProperties.controls.size.controls.height" class="e2e-height">
            </sci-form-field>

            <sci-form-field label="Max Height">
              <input [formControl]="this.form.controls.messageBoxProperties.controls.size.controls.maxHeight" class="e2e-max-height">
            </sci-form-field>

            <sci-form-field label="Min Width">
              <input [formControl]="this.form.controls.messageBoxProperties.controls.size.controls.minWidth" class="e2e-min-width">
            </sci-form-field>

            <sci-form-field label="Width">
              <input [formControl]="this.form.controls.messageBoxProperties.controls.size.controls.width" class="e2e-width">
            </sci-form-field>

            <sci-form-field label="Max Width">
              <input [formControl]="this.form.controls.messageBoxProperties.controls.size.controls.maxWidth" class="e2e-max-width">
            </sci-form-field>
          </ng-container>

          <sci-form-field label="Show Splash">
            <sci-checkbox [formControl]="this.form.controls.messageBoxProperties.controls.showSplash" class="e2e-show-splash"/>
          </sci-form-field>

          <sci-form-field label="CSS Class(es)">
            <app-multi-value-input [formControl]="form.controls.messageBoxProperties.controls.cssClass" [placeholder]="'class-1 class-2'" class="e2e-class"/>
          </sci-form-field>
        </ng-container>
      }
    }
  </section>

  <button (click)="onRegister()" class="e2e-register" [disabled]="form.invalid" sci-primary>Register</button>

  @if (capability) {
    <output class="register-response">
      Capability ID: {{capability.metadata!.id}}
    </output>

    <output class="register-response e2e-register-response">
      <sci-viewport>
        <div class="e2e-capability">{{capability | json}}</div>
      </sci-viewport>
    </output>
  }

  @if (registerError) {
    <output class="register-error e2e-register-error">
      {{registerError}}
    </output>
  }
</form>
